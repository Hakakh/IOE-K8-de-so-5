<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IOE English Master - K8 Đề số 5</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <style>
      body { font-family: 'Nunito', sans-serif; }
      .custom-scrollbar::-webkit-scrollbar { width: 8px; }
      .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
      .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
      
      @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
      .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
      @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
      .animate-slide-up { animation: slideUp 0.4s ease-out forwards; }
      @keyframes bounceShort { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
      .animate-bounce-short { animation: bounceShort 1s infinite; }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
</head>
<body class="bg-slate-100 text-slate-800 antialiased min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- 1. TYPES & DATA ---
        const QuestionType = {
            MULTIPLE_CHOICE: 'MULTIPLE_CHOICE',
            FILL_IN_BLANK: 'FILL_IN_BLANK',
            REARRANGE: 'REARRANGE'
        };

        const GameState = {
            START: 'START',
            PLAYING: 'PLAYING',
            FINISHED: 'FINISHED'
        };

        const cleanUrl = (url) => {
            if (!url) return undefined;
            return url.trim()
                .replace(/\s+/g, '')
                .replace(/res\.ioe\.vnzedu/, 'res.ioe.vn/edu')
                .replace(/res\.ioe\.vii/, 'res.ioe.vn')
                .replace(/res\.ioe\.vm/, 'res.ioe.vn')
                .replace(/Audio\s*mp3/i, 'Audio.mp3')
                .replace(/ImageExam\s*(\d)/, 'ImageExam/$1')
                .replace(/Olympic\s*ExamData/, 'OlympicExamData')
                .replace(/EOlympic\s*ExamData/, 'EOlympic/ExamData')
                .replace(/'/g, '')
                .replace(/Audio-mp3/i, 'Audio.mp3');
        };

        // DATA SOURCE: IOE K8 EXAM 05
        const QUIZ_DATA = [
  { id: 1, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["The ASEAN", "1967.", "was", "established", "in"], correctAnswer: "The ASEAN was established in 1967.", explanation: "Hiệp hội các quốc gia Đông Nam Á (ASEAN) được thành lập năm 1967." },
  { id: 2, type: QuestionType.FILL_IN_BLANK, questionText: "At school we had a long discussion about the best way to _ _ _ _ _  a foreign language.", correctAnswer: "master", explanation: "Master a language: Thành thạo một ngôn ngữ." },
  { id: 3, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently:", options: ["noses", "misses", "glasses", "mixes"], correctAnswer: "noses", explanation: "'Noses' đuôi -es phát âm là /z/, các từ còn lại là /iz/." },
  { id: 4, type: QuestionType.FILL_IN_BLANK, questionText: "“Buy” is an irre_ _ _ _ r verb. It changes into “bought” in the past form.", correctAnswer: "gula", explanation: "Irregular verb: Động từ bất quy tắc." },
  { id: 5, type: QuestionType.FILL_IN_BLANK, questionText: "John asked me _ _  I was interested in any kind of sports.", correctAnswer: "if", explanation: "Asked me if...: Hỏi tôi liệu rằng..." },
  { id: 6, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the part that needs correction: This is the first time I took part in the flower-arranging contest.", options: ["is", "took", "in", "flower-arranging"], correctAnswer: "took", explanation: "This is the first time + Present Perfect (have taken)." },
  { id: 7, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the newspaper to", "in the entertainment of", "You must look", "find out what", "films are showing."], correctAnswer: "You must look in the entertainment of the newspaper to find out what films are showing.", explanation: "Bạn phải xem mục giải trí của tờ báo để biết phim nào đang chiếu." },
  { id: 8, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["an increase in road accidents.", "because there has been", "Doctors and nurses", "have been working", "under great pressure"], correctAnswer: "Doctors and nurses have been working under great pressure because there has been an increase in road accidents.", explanation: "Các bác sĩ và y tá đang làm việc dưới áp lực lớn vì tai nạn giao thông gia tăng." },
  { id: 9, type: QuestionType.MULTIPLE_CHOICE, questionText: "My uncle is a heavy smoker. He gets ... a lot.", options: ["used to smoke", "used to smoking", "use to smoke", "use to smoking"], correctAnswer: "used to smoking", explanation: "Get used to + V-ing: Quen với việc gì." },
  { id: 10, type: QuestionType.FILL_IN_BLANK, questionText: "We enjoyed the hot summer days in the _ _ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/3/3/636241443376192412_Audio.mp3"), correctAnswer: "village", explanation: "Village: Ngôi làng." },
  { id: 11, type: QuestionType.MULTIPLE_CHOICE, questionText: "The city theater ... in 1900.", options: ["was built", "built", "has been built", "will be built"], correctAnswer: "was built", explanation: "In 1900 (quá khứ) -> Bị động quá khứ đơn." },
  { id: 12, type: QuestionType.FILL_IN_BLANK, questionText: "A piece of paper is really _ _ _ _  up of tiny fibers, unlike a piece of material.", correctAnswer: "made", explanation: "Made up of: Được tạo thành từ." },
  { id: 13, type: QuestionType.FILL_IN_BLANK, questionText: "There was a scary big _ _ _ _ _  on Christmas Day.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/11/30/636791797713470806_Audio.mp3"), correctAnswer: "storm", explanation: "Storm: Cơn bão." },
  { id: 14, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to his office.", "took him", "It", "half an hour", "to drive"], correctAnswer: "It took him half an hour to drive to his office.", explanation: "Anh ấy mất nửa giờ để lái xe đến văn phòng." },
  { id: 15, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently:", options: ["score", "household", "phone", "total"], correctAnswer: "score", explanation: "'Score' /ɔː/, các từ còn lại /əʊ/." },
  { id: 16, type: QuestionType.MULTIPLE_CHOICE, questionText: "___ happens when water in lakes, rivers and oceans is polluted.", options: ["Air pollution", "Water pollution", "Soil pollution", "Food pollution"], correctAnswer: "Water pollution", explanation: "Ô nhiễm nước." },
  { id: 17, type: QuestionType.FILL_IN_BLANK, questionText: "_ _  meet people, the Web is generally a very friendly place.", correctAnswer: "To", explanation: "To meet people: Để gặp gỡ mọi người." },
  { id: 18, type: QuestionType.FILL_IN_BLANK, questionText: "Glasses, bottles and vases are glassware, aren’t _ _ _ _ ?", correctAnswer: "they", explanation: "Câu hỏi đuôi số nhiều (are -> aren't they)." },
  { id: 19, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently:", options: ["buffalo", "pull", "struture", "uncle"], correctAnswer: "pull", explanation: "'Pull' /ʊ/, các từ còn lại /ʌ/." },
  { id: 20, type: QuestionType.MULTIPLE_CHOICE, questionText: "In 2019, more than 1,300 tourists ____ through Sary-Mogol.", options: ["pass", "had passed", "passed", "have passed"], correctAnswer: "passed", explanation: "In 2019 -> Quá khứ đơn." },
  { id: 21, type: QuestionType.FILL_IN_BLANK, questionText: "You learn a foreign language to be _ _ _ _  to communicate with the people who speak it.", correctAnswer: "able", explanation: "Be able to: Có thể." },
  { id: 22, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Duringthewar", "the enemy.", "their lands", "were occupied", "by"], correctAnswer: "Their lands were occupied by the enemy during the war.", explanation: "Vùng đất của họ bị chiếm đóng bởi kẻ thù trong chiến tranh." },
  { id: 23, type: QuestionType.MULTIPLE_CHOICE, questionText: "Find the word that has a different stress pattern:", options: ["capital", "secondary", "continue", "currency"], correctAnswer: "continue", explanation: "'Continue' nhấn âm 2, các từ còn lại nhấn âm 1." },
  { id: 24, type: QuestionType.FILL_IN_BLANK, questionText: "Tim doesn’t love comedies any _ _ _ _ _ _ .", correctAnswer: "longer", explanation: "Not ... any longer: Không còn nữa." },
  { id: 25, type: QuestionType.FILL_IN_BLANK, questionText: "The city library _ _ _  closed so I didn’t borrow any books.", correctAnswer: "was", explanation: "Was closed: Đã đóng cửa." },
  { id: 26, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ _  day of the week is the School’s festival day?", correctAnswer: "Which", explanation: "Which day: Ngày nào." },
  { id: 27, type: QuestionType.MULTIPLE_CHOICE, questionText: "The professor gave an interesting … on the global climates.", options: ["talk", "tell", "speak", "say"], correctAnswer: "talk", explanation: "Give a talk: Có bài nói chuyện." },
  { id: 28, type: QuestionType.FILL_IN_BLANK, questionText: "We say “chicken c_ _ _ ” and “buffalo shed”.", correctAnswer: "oop", explanation: "Chicken coop: Chuồng gà." },
  { id: 29, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently.", options: ["Internet", "access", "invent", "respond"], correctAnswer: "access", explanation: "'Access' /æ/, các từ còn lại /e/ hoặc /ɪ/." },
  { id: 30, type: QuestionType.MULTIPLE_CHOICE, questionText: "The policemen are happy ______ the kids safe and sound now.", options: ["finding", "to find", "have found", "to be found"], correctAnswer: "to find", explanation: "Happy + to V." },
  { id: 31, type: QuestionType.FILL_IN_BLANK, questionText: "Where will you go _ _  New Year’s Day?", correctAnswer: "on", explanation: "On New Year's Day." },
  { id: 32, type: QuestionType.FILL_IN_BLANK, questionText: "Katy is surprised _ _  the way Vietnamese people make banh chung.", correctAnswer: "at", explanation: "Surprised at: Ngạc nhiên về." },
  { id: 33, type: QuestionType.MULTIPLE_CHOICE, questionText: "Rewrite the sentence: What she fancy doing is to ride a bike around the park in the afternoon. --> What she is ___.", options: ["doing is to ride a bike around the park in the afternoon", "keen on doing is to ride a bike around the park in the afternoon", "doing is ride a bike around the park in the afternoon", "liking is to ride a bike around the park in the afternoon"], correctAnswer: "keen on doing is to ride a bike around the park in the afternoon", explanation: "Fancy doing ~ Keen on doing." },
  { id: 34, type: QuestionType.MULTIPLE_CHOICE, questionText: "Lan is really interested in … to music on the FM radio.", options: ["listen", "listens", "listening", "to listen"], correctAnswer: "listening", explanation: "Interested in + V-ing." },
  { id: 35, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["finishing the assignment on", "Blake reminded", "me", "time.", "of"], correctAnswer: "Blake reminded me of finishing the assignment on time.", explanation: "Blake nhắc tôi hoàn thành bài tập đúng hạn." },
  { id: 36, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which word has different stress pattern?", options: ["delightful", "equation", "stomach", "material"], correctAnswer: "stomach", explanation: "'Stomach' nhấn âm 1, các từ còn lại nhấn âm 2." },
  { id: 37, type: QuestionType.MULTIPLE_CHOICE, questionText: "What is the most difficult for young children to learn to play the musical instrument like violin or guitar?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/4/10/636589566638305575_Audio.mp3"), options: ["Where to put the fingers", "How to remember all musical notes", "Where to buy music books", "How to concentrate on playing the musical instrument"], correctAnswer: "Where to put the fingers", explanation: "Nghe audio: Đặt ngón tay ở đâu." },
  { id: 38, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["not to", "told me", "My father", "go", "too far."], correctAnswer: "My father told me not to go too far.", explanation: "Bố bảo tôi đừng đi quá xa." },
  { id: 39, type: QuestionType.MULTIPLE_CHOICE, questionText: "I ... in England for a few weeks now.", options: ["has been staying", "am staying", "have been staying", "stay"], correctAnswer: "have been staying", explanation: "For a few weeks now -> Present Perfect Continuous." },
  { id: 40, type: QuestionType.FILL_IN_BLANK, questionText: "The teacher tells us to fill in the miss_ _ _  information in the report.", correctAnswer: "ing", explanation: "Missing information: Thông tin còn thiếu." },
  { id: 41, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["her", "to him.", "He asked", "describe", "me to"], correctAnswer: "He asked me to describe her to him.", explanation: "Anh ấy yêu cầu tôi miêu tả cô ấy cho anh ấy." },
  { id: 42, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["can grow", "potatoes", "in", "People", "this farm."], correctAnswer: "People can grow potatoes in this farm.", explanation: "Mọi người có thể trồng khoai tây ở trang trại này." },
  { id: 43, type: QuestionType.MULTIPLE_CHOICE, questionText: "We watched a television program ... ’’Little flowers’’ last night.", options: ["call", "called", "calling", "calls"], correctAnswer: "called", explanation: "Called: Được gọi là (Rút gọn mệnh đề quan hệ)." },
  { id: 44, type: QuestionType.MULTIPLE_CHOICE, questionText: "Before ... this article I heard about the incident from my friends.", options: ["read", "reading", "to read", "to reading"], correctAnswer: "reading", explanation: "Before + V-ing." },
  { id: 45, type: QuestionType.MULTIPLE_CHOICE, questionText: "John is ... kind boy that everyone likes him.", options: ["so", "such", "very", "such a"], correctAnswer: "such a", explanation: "Such a + adj + noun singular." },
  { id: 46, type: QuestionType.FILL_IN_BLANK, questionText: "Please don’t play your music _ _  loudly.", correctAnswer: "so", explanation: "So loudly: Quá to." },
  { id: 47, type: QuestionType.FILL_IN_BLANK, questionText: "The hens and cocks live in the _ _ _ _ .", correctAnswer: "coop", explanation: "Coop: Chuồng gà." },
  { id: 48, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["your aunt?", "Did the dressmaker", "dress for", "and make the", "buy material"], correctAnswer: "Did the dressmaker buy material and make the dress for your aunt?", explanation: "Thợ may đã mua vải và may váy cho dì của bạn phải không?" },
  { id: 49, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["an interesting", "last", "There was", "night.", "quiz on"], correctAnswer: "There was an interesting quiz on last night.", explanation: "Có một câu đố thú vị vào tối qua." },
  { id: 50, type: QuestionType.MULTIPLE_CHOICE, questionText: "I don’t like pop music. My sister doesn’t like it ....", options: ["neither", "either", "too", "so"], correctAnswer: "either", explanation: "Câu phủ định cuối câu dùng either." },
  { id: 51, type: QuestionType.FILL_IN_BLANK, questionText: "As far as I _ _ _ _ , the bridge is going to be reconstructed by a foreign company.", correctAnswer: "know", explanation: "As far as I know: Theo tôi biết." },
  { id: 52, type: QuestionType.FILL_IN_BLANK, questionText: "Yesterday I met a foreigner, she asked me _ _  I spoke English.", correctAnswer: "if", explanation: "Asked if...: Hỏi liệu..." },
  { id: 53, type: QuestionType.MULTIPLE_CHOICE, questionText: "Rewrite the sentence: Children take part in many after-school activities when school finishes. --> Children do ___.", options: ["many after-school activities before school finishes", "much after-school activities when school finishes", "many activities when school finishes", "many after-school activities when school finishes"], correctAnswer: "many after-school activities when school finishes", explanation: "Take part in ~ Do." },
  { id: 54, type: QuestionType.MULTIPLE_CHOICE, questionText: "My father becomes ... after the accident.", options: ["weak", "weaken", "weekly", "to be weak"], correctAnswer: "weak", explanation: "Become + Adj." },
  { id: 55, type: QuestionType.FILL_IN_BLANK, questionText: "The Tay is one of 54 _ _ _ _ _ _  minority groups in Viet Nam.", correctAnswer: "ethnic", explanation: "Ethnic minority: Dân tộc thiểu số." },
  { id: 56, type: QuestionType.FILL_IN_BLANK, questionText: "He will fail the exam _ _ _ _ _ _  he studies harder.", correctAnswer: "unless", explanation: "Unless: Trừ khi." },
  { id: 57, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["took the child’s", "hand and", "helped him", "The mother", "climb the steps."], correctAnswer: "The mother took the child’s hand and helped him climb the steps.", explanation: "Người mẹ nắm tay đứa trẻ và giúp nó leo lên các bậc thang." },
  { id: 58, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["your car?", "mind", "Do you", "if I", "borrow"], correctAnswer: "Do you mind if I borrow your car?", explanation: "Bạn có phiền nếu tôi mượn xe không?" },
  { id: 59, type: QuestionType.FILL_IN_BLANK, questionText: "Please send an _ _ _ _ _ _ _ _ _  to Nguyen Trai School, a student is hurt.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2013/11/27/635211437821387756_Audio.mp3"), correctAnswer: "ambulance", explanation: "Ambulance: Xe cứu thương." },
  { id: 60, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["whether Justin", "his parents.", "living with", "I wondered", "was"], correctAnswer: "I wondered whether Justin was living with his parents.", explanation: "Tôi tự hỏi liệu Justin có đang sống cùng bố mẹ không." },
  { id: 61, type: QuestionType.MULTIPLE_CHOICE, questionText: "What time does the movie start? – It starts at ….", options: ["twenty to eight", "quarter past seven", "half past eight", "eight twenty"], correctAnswer: "eight twenty", explanation: "8:20." },
  { id: 62, type: QuestionType.FILL_IN_BLANK, questionText: "How long does it _ _ _ _  before you can use the compost?", correctAnswer: "take", explanation: "How long does it take: Mất bao lâu." },
  { id: 63, type: QuestionType.FILL_IN_BLANK, questionText: "We are trying our _ _ _ _  to finish this task on time.", correctAnswer: "best", explanation: "Try our best: Cố gắng hết sức." },
  { id: 64, type: QuestionType.FILL_IN_BLANK, questionText: "The newest model has several _ _ _ _ _ _ _ _ _ _  over its rivals.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/1/13/636199129707107137_Audio.mp3"), correctAnswer: "advantages", explanation: "Advantages: Lợi thế." },
  { id: 65, type: QuestionType.FILL_IN_BLANK, questionText: "She brought three children up single-handedly, often at great personal _ _ _ _ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/1/13/636199130745855469_Audio.mp3"), correctAnswer: "sacrifice", explanation: "Sacrifice: Hy sinh." },
  { id: 66, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the weather", "The forecast", "but cold.", "says", "will be sunny"], correctAnswer: "The forecast says the weather will be sunny but cold.", explanation: "Dự báo thời tiết nói trời sẽ nắng nhưng lạnh." },
  { id: 67, type: QuestionType.FILL_IN_BLANK, questionText: "Despite knowing the area well, I _ _ _  lost.", correctAnswer: "got", explanation: "Got lost: Bị lạc." },
  { id: 68, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the animals.", "to look after", "We are going", "some money", "to give", "to the zoo"], correctAnswer: "We are going to give some money to the zoo to look after the animals.", explanation: "Chúng tôi sẽ quyên góp tiền cho sở thú để chăm sóc động vật." },
  { id: 69, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has the underlined part pronounced differently from the others:", options: ["presents", "symptoms", "chopsticks", "patients"], correctAnswer: "presents", explanation: "'Presents' /z/, các từ còn lại /s/." },
  { id: 70, type: QuestionType.FILL_IN_BLANK, questionText: "He wrote his most famous plays between 1999 _ _ _  2005.", correctAnswer: "and", explanation: "Between... and..." },
  { id: 71, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["I find", "Harold’s", "incomprehensible.", "behaviour", "quite"], correctAnswer: "I find Harold’s behaviour quite incomprehensible.", explanation: "Tôi thấy hành vi của Harold khá khó hiểu." },
  { id: 72, type: QuestionType.FILL_IN_BLANK, questionText: "They will make sure that I’m ready for my _ _ _ _ _ _ _ _ _ .", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2019/2/23/636865178683917873_Audio.mp3"), correctAnswer: "operation", explanation: "Operation: Ca phẫu thuật." },
  { id: 73, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["visit the dentist", "when they have", "A lot of people", "their teeth.", "problems with"], correctAnswer: "A lot of people visit the dentist when they have problems with their teeth.", explanation: "Nhiều người đi nha sĩ khi họ gặp vấn đề về răng." },
  { id: 74, type: QuestionType.FILL_IN_BLANK, questionText: "He asked me if I would go there the _ _ _ _  day.", correctAnswer: "next", explanation: "The next day: Ngày hôm sau (Tường thuật)." },
  { id: 75, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the East of", "living in a town in", "an exchange student", "Nga is", "London."], correctAnswer: "Nga is an exchange student living in a town in the East of London.", explanation: "Nga là sinh viên trao đổi sống ở một thị trấn phía Đông London." },
  { id: 76, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["broke the", "of her", "glass because", "carelessness.", "Mai"], correctAnswer: "Mai broke the glass because of her carelessness.", explanation: "Mai làm vỡ ly vì sự bất cẩn của mình." },
  { id: 77, type: QuestionType.FILL_IN_BLANK, questionText: "After dinner, their neighbors gathered both inside _ _ _  outside their houses to watch TV.", correctAnswer: "and", explanation: "Both... and..." },
  { id: 78, type: QuestionType.MULTIPLE_CHOICE, questionText: "The teacher said that we … harder on our pronunciation.", options: ["work", "have worked", "should work", "working"], correctAnswer: "should work", explanation: "Khuyên bảo (should work)." },
  { id: 79, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["worn by", "school students.", "should be", "Uniform", "Secondary"], correctAnswer: "Uniform should be worn by Secondary school students.", explanation: "Học sinh trung học nên mặc đồng phục." },
  { id: 80, type: QuestionType.MULTIPLE_CHOICE, questionText: "After the flood, people in this province have to face up ... famine.", options: ["to", "for", "on", "with"], correctAnswer: "to", explanation: "Face up to: Đối mặt với." },
  { id: 81, type: QuestionType.MULTIPLE_CHOICE, questionText: "What were you doing when the light went you? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/1/7/635247067607069608_Audio.mp3"), options: ["I was tasting a cake", "I was doing a cake", "I was making a cake", "I was laying the cake"], correctAnswer: "I was making a cake", explanation: "Nghe audio." },
  { id: 82, type: QuestionType.MULTIPLE_CHOICE, questionText: "Where ___ he ___ some English students?", options: ["did – met", "had – meet", "has - meet", "did - meet"], correctAnswer: "did - meet", explanation: "Quá khứ đơn (Did + S + V-bare)." },
  { id: 83, type: QuestionType.FILL_IN_BLANK, questionText: "The man had to leave the office _ _ _ _ _ _ _ _ _ _ _  because he did not feel well.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/1/9/635563974295234205_Audio.mp3"), correctAnswer: "immediately", explanation: "Immediately: Ngay lập tức." },
  { id: 84, type: QuestionType.MULTIPLE_CHOICE, questionText: "Why did William climb the coco tree and get a coconut?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/1/13/636199059473748319_Audio.mp3"), options: ["Because David was so thin.", "Because David was so thirsty.", "Because William was so thirsty.", "Because William was so hungry."], correctAnswer: "Because David was so thirsty.", explanation: "Nghe audio." },
  { id: 85, type: QuestionType.FILL_IN_BLANK, questionText: "Were you ever in a situation that was an _ _ _ _ _ _ _ _ _ ?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/3/3/636241451689334981_Audio.mp3"), correctAnswer: "emergency", explanation: "Emergency: Tình huống khẩn cấp." },
  { id: 86, type: QuestionType.FILL_IN_BLANK, questionText: "The last _ _ _ _  we visited Kuala Lumpur was two years ago.", correctAnswer: "time", explanation: "The last time: Lần cuối." },
  { id: 87, type: QuestionType.MULTIPLE_CHOICE, questionText: "She bought potatoes ... cabbage at the market.", options: ["although", "and", "however", "but"], correctAnswer: "and", explanation: "And: Và." },
  { id: 88, type: QuestionType.FILL_IN_BLANK, questionText: "Columbus discovered America in the 15th _ _ _ _ _ _ _ .", correctAnswer: "century", explanation: "Century: Thế kỷ." },
  { id: 89, type: QuestionType.MULTIPLE_CHOICE, questionText: "I can remember … a strange noise in the middle of the night.", options: ["hear", "heard", "hearing", "to hear"], correctAnswer: "hearing", explanation: "Remember doing: Nhớ đã làm gì." },
  { id: 90, type: QuestionType.FILL_IN_BLANK, questionText: "She looked pretty _ _  a simple cotton dress.", correctAnswer: "in", explanation: "In a dress: Mặc váy." },
  { id: 91, type: QuestionType.FILL_IN_BLANK, questionText: "We’ll have a _ _ _ _ _ _ _ _  at the beach.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/3/2/636555791808308816_Audio.mp3"), correctAnswer: "campfire", explanation: "Campfire: Lửa trại." },
  { id: 92, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["how dinosaurs", "and learned", "dinosaur museum", "to the", "lived.", "We went"], correctAnswer: "We went to the dinosaur museum and learned how dinosaurs lived.", explanation: "Chúng tôi đến bảo tàng khủng long và học cách chúng sống." },
  { id: 93, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["my car’s", "afraid", "down.", "broken", "I’m"], correctAnswer: "I’m afraid my car’s broken down.", explanation: "Tôi e rằng xe tôi bị hỏng." },
  { id: 94, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has different stress pattern:", options: ["treatment", "injure", "doctor", "inject"], correctAnswer: "inject", explanation: "'Inject' nhấn âm 2, các từ còn lại nhấn âm 1." },
  { id: 95, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["me", "It takes", "ten minutes", "to go", "to school."], correctAnswer: "It takes me ten minutes to go to school.", explanation: "Tôi mất 10 phút để đi đến trường." },
  { id: 96, type: QuestionType.MULTIPLE_CHOICE, questionText: "It’s a pity that I ___ “Green Summer” programme last year.", options: ["don’t join", "didn’t join", "won’t join", "haven’t joined"], correctAnswer: "didn’t join", explanation: "Last year -> Past Simple." },
  { id: 97, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["looking", "after", "their time", "My grandparents", "spend", "the garden."], correctAnswer: "My grandparents spend their time looking after the garden.", explanation: "Ông bà tôi dành thời gian chăm sóc khu vườn." },
  { id: 98, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["serious heart", "it gave him", "a terrible scare.", "attack, but", "It wasn't a"], correctAnswer: "It wasn't a serious heart attack, but it gave him a terrible scare.", explanation: "Không phải cơn đau tim nghiêm trọng nhưng nó làm ông ấy hoảng sợ." },
  { id: 99, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["work in London.", "live and", "More than", "7 million people"], correctAnswer: "More than 7 million people live and work in London.", explanation: "Hơn 7 triệu người sống và làm việc ở London." },
  { id: 100, type: QuestionType.FILL_IN_BLANK, questionText: "Van is an international student in _ _ _  USA.", correctAnswer: "the", explanation: "The USA." },
  { id: 101, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["It’s important", "to read about", "to avoid them.", "and how", "home accident"], correctAnswer: "It’s important to read about home accident and how to avoid them.", explanation: "Đọc về tai nạn trong nhà và cách phòng tránh rất quan trọng." },
  { id: 102, type: QuestionType.MULTIPLE_CHOICE, questionText: "Rice ... in tropical countries.", options: ["grows", "grew", "is grown", "is growing"], correctAnswer: "is grown", explanation: "Bị động (Được trồng)." },
  { id: 103, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["to his own village.", "On Sunday,", "on a day trip", "Teddy invited Liz", "to join his family"], correctAnswer: "On Sunday, Teddy invited Liz to join his family on a day trip to his own village.", explanation: "Vào Chủ nhật, Teddy mời Liz tham gia chuyến đi cùng gia đình về quê." },
  { id: 104, type: QuestionType.MULTIPLE_CHOICE, questionText: "They ... in that house for several months", options: ["have lived", "lived", "live", "are living"], correctAnswer: "have lived", explanation: "For several months -> Present Perfect." },
  { id: 105, type: QuestionType.FILL_IN_BLANK, questionText: "This is the first time I have _ _ _ _  seen snow.", correctAnswer: "ever", explanation: "Have ever seen." },
  { id: 106, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ ’s hard to open this box by hand.", correctAnswer: "It", explanation: "It's hard..." },
  { id: 107, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["is crying", "her mother.", "for", "in an armchair", "The baby sitting"], correctAnswer: "The baby sitting in an armchair is crying for her mother.", explanation: "Đứa bé ngồi trên ghế bành đang khóc đòi mẹ." },
  { id: 108, type: QuestionType.FILL_IN_BLANK, questionText: "They have known each _ _ _ _ _  for a long time.", correctAnswer: "other", explanation: "Each other: Lẫn nhau." },
  { id: 109, type: QuestionType.FILL_IN_BLANK, questionText: "Volunteers walked _ _ _ _ _  the shore to collect trash.", correctAnswer: "along", explanation: "Along the shore: Dọc bờ biển." },
  { id: 110, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which sentences is correct?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/4/11/636590584242298624_Audio.mp3"), options: ["The Great Wall of China is about 7000 kilometres long and 7 kilometers high.", "The Great Wall of China has many towers that are more than 7 metres.", "The Great Wall of China was built only by prisoners and citizens.", "The Great Wall of China was built only with stone."], correctAnswer: "The Great Wall of China has many towers that are more than 7 metres.", explanation: "Nghe audio." },
  { id: 111, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the news.", "I'll", "Tom", "tell him", "If I see"], correctAnswer: "If I see Tom I'll tell him the news.", explanation: "Nếu tôi gặp Tom tôi sẽ báo tin cho anh ấy." },
  { id: 112, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["most beautiful mountainous", "resort in the", "considered the", "North of Vietnam.", "Sa pa is"], correctAnswer: "Sa pa is considered the most beautiful mountainous resort in the North of Vietnam.", explanation: "Sapa được coi là khu nghỉ dưỡng miền núi đẹp nhất miền Bắc Việt Nam." },
  { id: 113, type: QuestionType.MULTIPLE_CHOICE, questionText: "Peter is not … to go swimming alone.", options: ["old enough", "enough old", "so old", "so young"], correctAnswer: "old enough", explanation: "Adj + enough." },
  { id: 114, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _ _ _  usually refers to a professional writer.", correctAnswer: "Author", explanation: "Author: Tác giả." },
  { id: 115, type: QuestionType.MULTIPLE_CHOICE, questionText: "The children felt ….. when their mother was coming back home.", options: ["excitement", "excited", "excitedly", "exciting"], correctAnswer: "excited", explanation: "Felt + adj (chỉ cảm xúc người)." },
  { id: 116, type: QuestionType.FILL_IN_BLANK, questionText: "The film was not interesting _ _ _ _ _ _  for me to watch.", correctAnswer: "enough", explanation: "Adj + enough." },
  { id: 117, type: QuestionType.FILL_IN_BLANK, questionText: "My first _ _ _ _ _ _ _ _ _  was to study all day, but this turned out to be impossible.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2015/1/9/635563984338273319_Audio.mp3"), correctAnswer: "intention", explanation: "Intention: Ý định." },
  { id: 118, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word whose underlined part is pronounced differently from other:", options: ["wicked", "looked", "cooked", "checked"], correctAnswer: "wicked", explanation: "'Wicked' /id/, các từ còn lại /t/." },
  { id: 119, type: QuestionType.FILL_IN_BLANK, questionText: "Over 50000 people in Ethiopia have died _ _  starvation in the past month.", correctAnswer: "of", explanation: "Died of: Chết vì." },
  { id: 120, type: QuestionType.MULTIPLE_CHOICE, questionText: "Millions of Christmas cards ... last month.", options: ["sent", "send", "are sent", "were sent"], correctAnswer: "were sent", explanation: "Bị động quá khứ (were sent)." },
  { id: 121, type: QuestionType.FILL_IN_BLANK, questionText: "Could I help you _ _ _ _  your luggage?", correctAnswer: "with", explanation: "Help with." },
  { id: 122, type: QuestionType.FILL_IN_BLANK, questionText: "The _ _ _ _  of dental treatment nowadays is much more expensive than it was before.", correctAnswer: "cost", explanation: "Cost: Chi phí." },
  { id: 123, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word whose main stress pattern is not the same as that of the others:", options: ["media", "paradise", "picturesque", "adulthood"], correctAnswer: "picturesque", explanation: "'Picturesque' nhấn âm 3, các từ còn lại nhấn âm 1." },
  { id: 124, type: QuestionType.FILL_IN_BLANK, questionText: "How _ _ _ _  have you known each other?", correctAnswer: "long", explanation: "How long: Bao lâu." },
  { id: 125, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word that has different stress pattern:", options: ["recover", "minimize", "aspirin", "medicine"], correctAnswer: "recover", explanation: "'Recover' nhấn âm 2, các từ còn lại nhấn âm 1." },
  { id: 126, type: QuestionType.FILL_IN_BLANK, questionText: "By _ _ _ _  was this story written?", correctAnswer: "whom", explanation: "By whom: Bởi ai." },
  { id: 127, type: QuestionType.MULTIPLE_CHOICE, questionText: "He has just bought a … car.", options: ["big beautiful Japanese red", "beautiful big red Japanese", "beautiful red big Japanese", "big Japanese red big"], correctAnswer: "beautiful big red Japanese", explanation: "Trật tự tính từ: OpSASCOMP (Opinion - Size - Color - Origin)." },
  { id: 128, type: QuestionType.MULTIPLE_CHOICE, questionText: "Which sentence is correct?", options: ["The drugstore is next the bakery to the park.", "The drugstore is next to the bakery and the park.", "The drugstore is next to the bakery to the park.", "The drugstore is to the bakery next the park."], correctAnswer: "The drugstore is next to the bakery and the park.", explanation: "Next to." },
  { id: 129, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["the country", "was born?", "tell me", "Can you", "where she"], correctAnswer: "Can you tell me the country where she was born?", explanation: "Bạn có thể cho tôi biết đất nước nơi cô ấy sinh ra không?" },
  { id: 130, type: QuestionType.FILL_IN_BLANK, questionText: "My brother enjoys watching detective films _ _ _  he doesn’t like reading detective stories.", correctAnswer: "but", explanation: "But: Nhưng." },
  { id: 131, type: QuestionType.FILL_IN_BLANK, questionText: "Cyberbullying can happen _ _  anyone.", correctAnswer: "to", explanation: "Happen to: Xảy ra với." },
  { id: 132, type: QuestionType.MULTIPLE_CHOICE, questionText: "You are responsible ____ her ____ your serious mistakes.", options: ["with - for", "for - about", "to - for", "with - about"], correctAnswer: "to - for", explanation: "Responsible to sb for sth." },
  { id: 133, type: QuestionType.FILL_IN_BLANK, questionText: "We intend to go for a picnic tomorrow. Now I’m waiting for the weather _ _ _ _ _ _ _ _  on TV.", correctAnswer: "forecast", explanation: "Weather forecast: Dự báo thời tiết." },
  { id: 134, type: QuestionType.FILL_IN_BLANK, questionText: "Fill _ _  each blank with the appropriate form of them word in the brackets.", correctAnswer: "in", explanation: "Fill in: Điền vào." },
  { id: 135, type: QuestionType.FILL_IN_BLANK, questionText: "When I _ _ _ _  home from work, my mother was cooking dinner.", correctAnswer: "came", explanation: "Came home." },
  { id: 136, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["He", "Monday morning.", "in Paris", "arrives", "on"], correctAnswer: "He arrives in Paris on Monday morning.", explanation: "Anh ấy đến Paris vào sáng thứ Hai." },
  { id: 137, type: QuestionType.MULTIPLE_CHOICE, questionText: "Listen and choose the sentence you hear:", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/11/14/635515794264756161_Audio.mp3"), options: ["The bat can’t see anything, it can hear only.", "The bat can see everything, it can hear nothing.", "The cat can’t see everything, it can hear only.", "The cat can see everything, it can hear only."], correctAnswer: "The bat can see everything, it can hear nothing.", explanation: "Nghe audio (Con dơi)." },
  { id: 138, type: QuestionType.MULTIPLE_CHOICE, questionText: "Quynh spends most of her free time ... volunteer work.", options: ["do", "to do", "doing", "for doing"], correctAnswer: "doing", explanation: "Spend time doing sth." },
  { id: 139, type: QuestionType.FILL_IN_BLANK, questionText: "My father can _ _ _ _ _  five languages fluently.", correctAnswer: "speak", explanation: "Speak languages: Nói ngôn ngữ." },
  { id: 140, type: QuestionType.MULTIPLE_CHOICE, questionText: "It was a boring weekend. I … anything.", options: ["didn’t", "don’t do", "didn’t do", "doesn’t do"], correctAnswer: "didn’t do", explanation: "Quá khứ đơn phủ định." },
  { id: 141, type: QuestionType.MULTIPLE_CHOICE, questionText: "Many people want to study English … it is an international language.", options: ["so", "that", "while", "because"], correctAnswer: "because", explanation: "Because: Bởi vì." },
  { id: 142, type: QuestionType.FILL_IN_BLANK, questionText: "My car was made _ _  Japan, you know?", correctAnswer: "in", explanation: "Made in Japan." },
  { id: 143, type: QuestionType.FILL_IN_BLANK, questionText: "_ _  night, the temperature seems to be colder and colder.", correctAnswer: "At", explanation: "At night." },
  { id: 144, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["I have", "nothing", "more to", "the subject.", "say on"], correctAnswer: "I have nothing more to say on the subject.", explanation: "Tôi không còn gì để nói về chủ đề này." },
  { id: 145, type: QuestionType.FILL_IN_BLANK, questionText: "Give me something to drink please! I’m dying of _ _ _ _ _ _ .", correctAnswer: "thirst", explanation: "Dying of thirst: Chết khát." },
  { id: 146, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["at", "I am", "the weekend.", "going shopping", "interested in"], correctAnswer: "I am interested in going shopping at the weekend.", explanation: "Tôi thích đi mua sắm vào cuối tuần." },
  { id: 147, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["near London.", "New York from", "flew to", "Gatwick Airport", "We"], correctAnswer: "We flew to New York from Gatwick Airport near London.", explanation: "Chúng tôi bay đến NY từ sân bay Gatwick gần London." },
  { id: 148, type: QuestionType.FILL_IN_BLANK, questionText: "She was quite _ _ _ _ _ _ _  and she sat there purring.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2017/3/3/636241450663710550_Audio.mp3"), correctAnswer: "content", explanation: "Content: Hài lòng/Mãn nguyện." },
  { id: 149, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["in the rain", "waiting for", "are getting wet.", "the bus", "The people"], correctAnswer: "The people waiting for the bus in the rain are getting wet.", explanation: "Những người đợi xe buýt dưới mưa đang bị ướt." },
  { id: 150, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _  do you like best about your school?", correctAnswer: "What", explanation: "What do you like..." },
  { id: 151, type: QuestionType.FILL_IN_BLANK, questionText: "She doesn’t enjoy looking _ _ _ _ _  the children.", correctAnswer: "after", explanation: "Look after." },
  { id: 152, type: QuestionType.FILL_IN_BLANK, questionText: "Thank you very much _ _ _  the flowers you gave me last night.", correctAnswer: "for", explanation: "Thank for." },
  { id: 153, type: QuestionType.MULTIPLE_CHOICE, questionText: "Odd one out:", options: ["magazine", "news", "radio", "Internet"], correctAnswer: "news", explanation: "'News' là nội dung, các từ còn lại là phương tiện." },
  { id: 154, type: QuestionType.MULTIPLE_CHOICE, questionText: "Minh Mang Tomb ___ construction in 1841, and ___ three years later.", options: ["started – completed", "started – was completed", "was started – was completed", "was started - completed"], correctAnswer: "started – was completed", explanation: "Bắt đầu (chủ động) - Hoàn thành (bị động)." },
  { id: 155, type: QuestionType.MULTIPLE_CHOICE, questionText: "Mark still went to the party ... he wasn’t invited.", options: ["because", "in spite of", "however", "although"], correctAnswer: "although", explanation: "Although + clause." },
  { id: 156, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Eating and talking", "recess in many countries.", "with friends are", "ways of relaxing at", "the most common"], correctAnswer: "Eating and talking with friends are the most common ways of relaxing at recess in many countries.", explanation: "Ăn uống và trò chuyện với bạn bè là cách thư giãn phổ biến nhất..." },
  { id: 157, type: QuestionType.MULTIPLE_CHOICE, questionText: "Our children are looking forward to … to the circus this weekend.", options: ["be taken", "taking", "being taken", "take"], correctAnswer: "being taken", explanation: "Look forward to + being V3 (Bị động)." },
  { id: 158, type: QuestionType.MULTIPLE_CHOICE, questionText: "She never wears red because it doesn’t ... her.", options: ["suit", "match", "fit", "like"], correctAnswer: "suit", explanation: "Suit: Hợp (với người)." },
  { id: 159, type: QuestionType.FILL_IN_BLANK, questionText: "_ _ _ _  looking and listening for traffic while you cross.", correctAnswer: "Keep", explanation: "Keep looking: Tiếp tục nhìn." },
  { id: 160, type: QuestionType.FILL_IN_BLANK, questionText: "S_ _ _ _ _ _  the Internet all day is a waste of time.", correctAnswer: "urfing", explanation: "Surfing the Internet." },
  { id: 161, type: QuestionType.FILL_IN_BLANK, questionText: "No animals runs so fast _ _  the cheetah.", correctAnswer: "as", explanation: "So... as..." },
  { id: 162, type: QuestionType.FILL_IN_BLANK, questionText: "I hope that he will get b_ _ _ _ _  soon.", correctAnswer: "etter", explanation: "Get better: Khỏe lại." },
  { id: 163, type: QuestionType.FILL_IN_BLANK, questionText: "Rescue operations have started and many people trapped in collapsed or _ _ _ _ _ _ _  buildings have been freed.", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2019/1/11/636828188507768128_Audio.mp3"), correctAnswer: "damaged", explanation: "Damaged: Bị hư hại." },
  { id: 164, type: QuestionType.MULTIPLE_CHOICE, questionText: "VTV is a ___ television channel in Viet Nam, and it attracts millions of TV viewers in Viet Nam.", options: ["wide", "local", "international", "national"], correctAnswer: "national", explanation: "National channel: Kênh quốc gia." },
  { id: 165, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["Now I", "don’t go to school", "I used to.", "as", "on foot"], correctAnswer: "Now I don’t go to school on foot as I used to.", explanation: "Bây giờ tôi không đi bộ đến trường như trước nữa." },
  { id: 166, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["She used to", "be fond of", "interest in it.", "pop music", "but has now lost"], correctAnswer: "She used to be fond of pop music but has now lost interest in it.", explanation: "Cô ấy từng thích nhạc pop nhưng giờ không còn hứng thú." },
  { id: 167, type: QuestionType.MULTIPLE_CHOICE, questionText: "Four-fifths of the world’s computers use programmes … English.", options: ["in", "with", "by", "from"], correctAnswer: "in", explanation: "In English: Bằng tiếng Anh." },
  { id: 168, type: QuestionType.MULTIPLE_CHOICE, questionText: "Nobody will support him, ...?", options: ["won’t they", "do they", "don’t they", "will they"], correctAnswer: "will they", explanation: "Nobody (phủ định) -> Question tag khẳng định." },
  { id: 169, type: QuestionType.FILL_IN_BLANK, questionText: "We were surprised that he _ _ _  the first prize in the environmental protection contest.", correctAnswer: "won", explanation: "Won prize: Giành giải." },
  { id: 170, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["is cutting", "with", "the cake", "Jane", "a sharp knife."], correctAnswer: "Jane is cutting the cake with a sharp knife.", explanation: "Jane đang cắt bánh bằng con dao sắc." },
  { id: 171, type: QuestionType.FILL_IN_BLANK, questionText: "This brochure is full _ _  useful information.", correctAnswer: "of", explanation: "Full of." },
  { id: 172, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["from London.", "not far", "lives on", "a farm", "My family"], correctAnswer: "My family lives on a farm not far from London.", explanation: "Gia đình tôi sống ở trang trại không xa London." },
  { id: 173, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["is a", "major", "environmental", "Air pollution", "risk", "to health."], correctAnswer: "Air pollution is a major environmental risk to health.", explanation: "Ô nhiễm không khí là rủi ro môi trường lớn đối với sức khỏe." },
  { id: 174, type: QuestionType.FILL_IN_BLANK, questionText: "How _ _  you like the hotel?", correctAnswer: "do", explanation: "How do you like..." },
  { id: 175, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["mind", "Do you", "your car?", "if I", "borrow"], correctAnswer: "Do you mind if I borrow your car?", explanation: "Bạn có phiền không nếu tôi mượn xe?" },
  { id: 176, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["just sent", "to", "They have", "the school.", "an ambulance"], correctAnswer: "They have just sent an ambulance to the school.", explanation: "Họ vừa gửi xe cứu thương đến trường." },
  { id: 177, type: QuestionType.MULTIPLE_CHOICE, questionText: "While formerly a member of the sports club, Mr .Teeters … tennis there regularly.", options: ["is used to playing", "was used to playing", "used to play", "used to playing"], correctAnswer: "used to play", explanation: "Used to V: Đã từng (thói quen quá khứ)." },
  { id: 178, type: QuestionType.FILL_IN_BLANK, questionText: "Thang: Would you mind _ _  I used your computer for an hour? – Nguyen: Please do.", correctAnswer: "if", explanation: "Mind if." },
  { id: 179, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["The secretary", "our factory", "next week.", "will arrange", "for you to visit"], correctAnswer: "The secretary will arrange for you to visit our factory next week.", explanation: "Thư ký sẽ sắp xếp cho bạn thăm nhà máy vào tuần tới." },
  { id: 180, type: QuestionType.MULTIPLE_CHOICE, questionText: "Choose the word whose underlined part is pronounced differently from others:", options: ["shy", "cry", "fry", "play"], correctAnswer: "play", explanation: "'Play' /eɪ/, các từ còn lại /aɪ/." },
  { id: 181, type: QuestionType.FILL_IN_BLANK, questionText: "I have to change the old car _ _ _ _ . It’s flat.", correctAnswer: "tire", explanation: "Car tire: Lốp xe." },
  { id: 182, type: QuestionType.FILL_IN_BLANK, questionText: "Her appearance was quite different _ _ _ _  what I had expected.", correctAnswer: "from", explanation: "Different from." },
  { id: 183, type: QuestionType.MULTIPLE_CHOICE, questionText: "“Let’s” is the short form of “...”.", options: ["Let is", "Let has", "Let ours", "Let us"], correctAnswer: "Let us", explanation: "Let's = Let us." },
  { id: 184, type: QuestionType.FILL_IN_BLANK, questionText: "The past simple form of “think” is “_ _ _ _ _ _ _ ”.", correctAnswer: "thought", explanation: "Thought." },
  { id: 185, type: QuestionType.MULTIPLE_CHOICE, questionText: "We say “It’s half past two” and we write “...”.", options: ["2.30", "30.2", "1.30", "30.1"], correctAnswer: "2.30", explanation: "2 giờ 30." },
  { id: 186, type: QuestionType.FILL_IN_BLANK, questionText: "’’Congratulations!’’ John _ _ _ _  to me yesterday.", correctAnswer: "said", explanation: "Said to me." },
  { id: 187, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["healthy and", "in", "This lifestyle kept", "us", "shape."], correctAnswer: "This lifestyle kept us healthy and in shape.", explanation: "Lối sống này giữ chúng tôi khỏe mạnh và cân đối." },
  { id: 188, type: QuestionType.FILL_IN_BLANK, questionText: "Hung and Tuan have corresponded _ _ _ _  each other for years.", correctAnswer: "with", explanation: "Correspond with: Trao đổi thư từ." },
  { id: 189, type: QuestionType.FILL_IN_BLANK, questionText: "Luu Quang Vu is probably one of the most famous _ _ _ _ wrights in Vietnam.", correctAnswer: "play", explanation: "Playwrights: Nhà viết kịch." },
  { id: 190, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["watching TV,", "some latest news", "about our ill uncle.", "he came to give us", "When we were"], correctAnswer: "When we were watching TV, he came to give us some latest news about our ill uncle.", explanation: "Khi chúng tôi đang xem TV, anh ấy đến báo tin về người chú bị ốm." },
  { id: 191, type: QuestionType.MULTIPLE_CHOICE, questionText: "The child threw herself to the ground and began to cry her … out.", options: ["tongue", "nose", "breath", "eyes"], correctAnswer: "eyes", explanation: "Cry eyes out: Khóc hết nước mắt." },
  { id: 192, type: QuestionType.FILL_IN_BLANK, questionText: "Glass is collected and sent to factories, where it is broken up, melted and _ _ _ _  into new glassware.", correctAnswer: "made", explanation: "Made into: Làm thành." },
  { id: 193, type: QuestionType.MULTIPLE_CHOICE, questionText: "Why did the Duke of Edinburgh start the award?", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2018/4/10/636589472030676610_Audio.mp3"), options: ["Because he wanted young children to get high scores in Physical Education at school.", "Because he wanted more people to have the same hobbies as his.", "Because he wanted the young to learn to help themselves and others exciting activities.", "Because the award symbolised his power in the country."], correctAnswer: "Because he wanted the young to learn to help themselves and others exciting activities.", explanation: "Nghe audio." },
  { id: 194, type: QuestionType.REARRANGE, questionText: "Sắp xếp câu:", rearrangeParts: ["that he had", "The boy", "won the", "first prize.", "said proudly"], correctAnswer: "The boy said proudly that he had won the first prize.", explanation: "Cậu bé tự hào nói rằng mình đã giành giải nhất." },
  { id: 195, type: QuestionType.MULTIPLE_CHOICE, questionText: "Vietnam is a ... country. The weather is usually hot there.", options: ["cold", "warm", "heat", "tropical"], correctAnswer: "tropical", explanation: "Tropical country: Nước nhiệt đới." },
  { id: 196, type: QuestionType.FILL_IN_BLANK, questionText: "I’m not sure, but as far _ _  I know he will stay at home on holiday.", correctAnswer: "as", explanation: "As far as I know." },
  { id: 197, type: QuestionType.MULTIPLE_CHOICE, questionText: "What does the ticket price consist of? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/1/7/635247064490482876_Audio.mp3"), options: ["Accommodation and services", "Instruction and services", "Accommodation and meals", "Instruction and meals"], correctAnswer: "Accommodation and meals", explanation: "Nghe audio." },
  { id: 198, type: QuestionType.MULTIPLE_CHOICE, questionText: "Don’t forget … the letter for me, Minh!", options: ["sending", "send", "sent", "to send"], correctAnswer: "to send", explanation: "Forget to V: Quên phải làm gì." },
  { id: 199, type: QuestionType.MULTIPLE_CHOICE, questionText: "What do many people say about Venice? - ....", audioUrl: cleanUrl("https://res.ioe.vn/edu/EOlympic/ExamData/ImageExam/2014/3/12/635302345962045125_Audio.mp3"), options: ["Venice is the most luxurious city in the world", "Venice is the most romantic city in the world", "Venice is the most wonderful city in the world", "Venice is the most beautiful city in the world"], correctAnswer: "Venice is the most beautiful city in the world", explanation: "Nghe audio." },
  { id: 200, type: QuestionType.FILL_IN_BLANK, questionText: "’’Can you play the piano?’’ Adam a_ _ _ _  the girl.", correctAnswer: "sked", explanation: "Asked: Hỏi." }
];

        // --- 2. COMPONENTS ---

        const AudioPlayer = ({ src }) => {
            const audioRef = useRef(null);
            const [isPlaying, setIsPlaying] = useState(false);

            useEffect(() => {
                setIsPlaying(false);
                if (audioRef.current) audioRef.current.load();
            }, [src]);

            const togglePlay = () => {
                if (audioRef.current) {
                    isPlaying ? audioRef.current.pause() : audioRef.current.play();
                    setIsPlaying(!isPlaying);
                }
            };

            return (
                <div className="flex items-center space-x-2 mt-4 mb-2 bg-blue-50 p-2 rounded-lg border border-blue-100 w-fit">
                    <button onClick={togglePlay} className={`w-10 h-10 flex items-center justify-center rounded-full transition-colors ${isPlaying ? 'bg-red-500 hover:bg-red-600' : 'bg-blue-500 hover:bg-blue-600'} text-white shadow-sm`}>
                        {isPlaying ? (
                            <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z" clipRule="evenodd" /></svg>
                        ) : (
                            <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clipRule="evenodd" /></svg>
                        )}
                    </button>
                    <span className="text-sm text-blue-800 font-medium">Listen</span>
                    <audio ref={audioRef} src={src} onEnded={() => setIsPlaying(false)} className="hidden" />
                </div>
            );
        };

        const QuestionCard = ({ question, onAnswerSubmit, showFeedback, userAnswer }) => {
            const [inputValue, setInputValue] = useState('');
            const [rearrangeOrder, setRearrangeOrder] = useState([]);
            const [availableParts, setAvailableParts] = useState([]);
            const [isHintVisible, setIsHintVisible] = useState(false);

            useEffect(() => {
                setInputValue('');
                setIsHintVisible(false);
                if (question.type === QuestionType.REARRANGE && question.rearrangeParts) {
                    setRearrangeOrder([]);
                    setAvailableParts([...question.rearrangeParts]);
                }
                if (userAnswer && question.type !== QuestionType.REARRANGE) {
                    setInputValue(userAnswer);
                }
            }, [question, userAnswer, showFeedback]);

            const handleSubmit = () => {
                if (showFeedback) return;
                let finalAnswer = '';
                if (question.type === QuestionType.MULTIPLE_CHOICE) finalAnswer = inputValue;
                else if (question.type === QuestionType.FILL_IN_BLANK) finalAnswer = inputValue.trim();
                else if (question.type === QuestionType.REARRANGE) finalAnswer = rearrangeOrder.join(' ');
                
                if (finalAnswer) onAnswerSubmit(finalAnswer);
            };

            const handleOptionClick = (option) => {
                if (showFeedback) return;
                setInputValue(option);
                onAnswerSubmit(option);
            };

            const handleRearrangeClick = (word, fromAvailable) => {
                if (showFeedback) return;
                if (fromAvailable) {
                    setAvailableParts(prev => prev.filter(w => w !== word));
                    setRearrangeOrder(prev => [...prev, word]);
                } else {
                    setRearrangeOrder(prev => prev.filter(w => w !== word));
                    setAvailableParts(prev => [...prev, word]);
                }
            };

            const isCorrect = userAnswer?.toLowerCase().trim() === question.correctAnswer.toLowerCase().trim();

            return (
                <div className="bg-white rounded-2xl shadow-xl p-6 md:p-8 max-w-3xl w-full mx-auto animate-fade-in relative overflow-hidden flex flex-col">
                    <div className="mb-6">
                        <div className="flex justify-between items-start mb-4">
                            <div className="flex gap-2 flex-wrap">
                                <span className="inline-block px-3 py-1 text-xs font-bold tracking-wider text-blue-600 bg-blue-100 rounded-full mb-2">QUESTION {question.id}</span>
                                {!showFeedback && (
                                    <button onClick={() => setIsHintVisible(!isHintVisible)} className={`inline-flex items-center px-3 py-1 text-xs font-bold tracking-wider rounded-full mb-2 transition-colors ${isHintVisible ? 'bg-yellow-200 text-yellow-800' : 'bg-yellow-100 text-yellow-700 hover:bg-yellow-200'}`}>
                                        {isHintVisible ? 'Hide Hint' : 'Show Hint'}
                                    </button>
                                )}
                            </div>
                        </div>
                        
                        {isHintVisible && !showFeedback && (
                            <div className="mb-6 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg animate-fade-in">
                                <p className="text-sm text-yellow-800 font-bold mb-1">Gợi ý (Hint):</p>
                                <p className="text-sm text-yellow-900 italic">{question.explanation}</p>
                            </div>
                        )}
                        
                        <h2 className="text-xl md:text-2xl font-bold text-gray-800 mb-6 leading-relaxed">{question.questionText}</h2>
                        
                        {question.imageUrl && (
                            <div className="mb-6 rounded-xl overflow-hidden border border-gray-100 shadow-sm bg-gray-50 flex justify-center p-2">
                                <img src={question.imageUrl} alt="Question Image" className="max-w-full h-auto max-h-[300px] object-contain rounded-lg" />
                            </div>
                        )}
                        
                        {question.audioUrl && (
                            <div className="flex justify-center mb-6"><AudioPlayer src={question.audioUrl} /></div>
                        )}
                    </div>

                    <div className="mb-8 flex-grow">
                        {question.type === QuestionType.MULTIPLE_CHOICE && question.options && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                {question.options.map((option, idx) => {
                                    let btnClass = "w-full text-left p-4 rounded-xl border-2 transition-all duration-200 flex items-center shadow-sm ";
                                    if (showFeedback) {
                                        if (option === question.correctAnswer) btnClass += "border-green-500 bg-green-50 text-green-800 font-bold shadow-green-100";
                                        else if (option === userAnswer && option !== question.correctAnswer) btnClass += "border-red-500 bg-red-50 text-red-800 opacity-80 shadow-red-100";
                                        else btnClass += "border-gray-100 text-gray-400 opacity-50 bg-gray-50";
                                    } else {
                                        btnClass += "border-gray-200 hover:border-blue-400 hover:bg-blue-50 text-gray-700 bg-white hover:shadow-md";
                                    }
                                    return (
                                        <button key={idx} onClick={() => handleOptionClick(option)} disabled={showFeedback} className={btnClass}>
                                            <div className={`w-8 h-8 rounded-full border-2 mr-3 flex-shrink-0 flex items-center justify-center font-bold text-sm ${showFeedback && option === question.correctAnswer ? 'border-green-500 bg-green-500 text-white' : showFeedback && option === userAnswer ? 'border-red-500 bg-red-500 text-white' : 'border-gray-300 text-gray-500'}`}>{['A', 'B', 'C', 'D'][idx]}</div>
                                            <span className="flex-grow">{option}</span>
                                        </button>
                                    );
                                })}
                            </div>
                        )}

                        {question.type === QuestionType.FILL_IN_BLANK && (
                            <div className="relative max-w-lg mx-auto">
                                <input type="text" value={inputValue} onChange={(e) => setInputValue(e.target.value)} onKeyDown={(e) => e.key === 'Enter' && handleSubmit()} disabled={showFeedback} placeholder="Type your answer..." className={`w-full p-4 pl-6 text-lg border-2 rounded-xl focus:outline-none transition-all shadow-sm ${showFeedback ? isCorrect ? 'border-green-500 bg-green-50 text-green-800 font-bold' : 'border-red-500 bg-red-50 text-red-800 font-bold' : 'border-gray-200 focus:border-blue-500 text-gray-800 focus:shadow-md'}`} />
                                {!showFeedback && <button onClick={handleSubmit} disabled={!inputValue.trim()} className="absolute right-2 top-2 bottom-2 bg-blue-600 text-white px-6 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50 transition-all">Submit</button>}
                            </div>
                        )}

                        {question.type === QuestionType.REARRANGE && (
                            <div className="space-y-6">
                                <div className={`min-h-[100px] p-5 rounded-xl border-2 flex flex-wrap gap-2 items-center content-start transition-colors ${showFeedback ? isCorrect ? 'border-green-500 bg-green-50' : 'border-red-500 bg-red-50' : 'border-blue-200 bg-blue-50/50'}`}>
                                    {rearrangeOrder.map((word, idx) => (
                                        <button key={`${word}-${idx}`} onClick={() => handleRearrangeClick(word, false)} disabled={showFeedback} className="bg-white border border-blue-200 text-blue-800 px-3 py-2 rounded-lg shadow-sm hover:bg-red-50 hover:border-red-200 hover:text-red-600 transition-colors font-medium animate-fade-in">{word}</button>
                                    ))}
                                </div>
                                {!showFeedback && (
                                    <div className="flex flex-wrap gap-2 justify-center p-4 bg-gray-50 rounded-xl border border-gray-100">
                                        {availableParts.map((word, idx) => (
                                            <button key={`${word}-${idx}`} onClick={() => handleRearrangeClick(word, true)} className="bg-white border border-gray-200 text-gray-700 px-4 py-2 rounded-lg shadow-sm hover:border-blue-400 hover:text-blue-600 hover:shadow-md transition-all">{word}</button>
                                        ))}
                                    </div>
                                )}
                                {!showFeedback && (
                                    <div className="flex justify-center mt-4">
                                        <button onClick={handleSubmit} disabled={rearrangeOrder.length === 0} className="bg-blue-600 text-white py-3 px-10 rounded-xl font-bold hover:bg-blue-700 shadow-lg disabled:opacity-50 transition-all transform hover:scale-105">Submit Answer</button>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>

                    {showFeedback && (
                        <div className={`mt-auto p-5 rounded-xl border-l-4 animate-slide-up shadow-sm ${isCorrect ? 'bg-green-50 border-green-500' : 'bg-red-50 border-red-500'}`}>
                            <div className="flex items-center mb-3">
                                <h3 className={`text-lg font-bold ${isCorrect ? 'text-green-800' : 'text-red-800'}`}>{isCorrect ? 'Correct!' : 'Incorrect'}</h3>
                            </div>
                            {!isCorrect && (
                                <div className="mb-4 text-red-800 bg-red-100/50 p-3 rounded-lg border border-red-100">
                                    <span className="font-bold text-xs uppercase tracking-wide opacity-70 mb-1 block">Correct Answer</span>
                                    <p className="font-semibold text-lg">{question.correctAnswer}</p>
                                </div>
                            )}
                            <div className="text-gray-700 pt-2">
                                <span className="font-bold text-xs uppercase tracking-wide text-gray-500 mb-1 block">Explanation</span>
                                <p className="leading-relaxed">{question.explanation}</p>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const StartScreen = ({ onStart, totalQuestions }) => {
            const [name, setName] = useState('');
            return (
                <div className="flex flex-col items-center justify-center min-h-[60vh] p-8 text-center animate-fade-in">
                    <div className="bg-white p-10 rounded-3xl shadow-2xl max-w-lg w-full">
                        <div className="w-24 h-24 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg animate-bounce-short">
                            <svg xmlns="http://www.w3.org/2000/svg" className="h-12 w-12 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>
                        </div>
                        <h1 className="text-3xl md:text-4xl font-extrabold text-slate-800 mb-2">IOE English Master</h1>
                        <p className="text-slate-500 text-lg mb-6 font-medium">Grade 8 - Exam #05</p>
                        <div className="text-left bg-slate-50 p-6 rounded-xl border border-slate-100 mb-6">
                            <label className="block text-sm font-bold text-slate-700 mb-2">Enter your name to start:</label>
                            <input type="text" value={name} onChange={(e) => setName(e.target.value)} onKeyDown={(e) => e.key === 'Enter' && name.trim() && onStart(name.trim())} placeholder="Your Name" className="w-full px-4 py-3 rounded-lg border-2 border-slate-200 focus:border-blue-500 outline-none font-bold text-slate-800" autoFocus />
                        </div>
                        <button onClick={() => name.trim() && onStart(name.trim())} disabled={!name.trim()} className="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg transition disabled:opacity-50">Start Exam</button>
                    </div>
                </div>
            );
        };

        const ResultScreen = ({ playerName, score, points, total, results, onRestart, onRetryWrong }) => {
            const percentage = total > 0 ? Math.round((score / total) * 100) : 0;
            const wrongCount = total - score;
            let message = percentage >= 90 ? "Outstanding!" : percentage >= 70 ? "Great Job!" : "Keep Practicing!";
            let color = percentage >= 90 ? "text-yellow-400" : percentage >= 70 ? "text-green-400" : "text-slate-300";

            return (
                <div className="flex flex-col items-center justify-center p-4 animate-fade-in max-w-2xl mx-auto w-full mb-10">
                    <div className="bg-white rounded-3xl shadow-2xl w-full overflow-hidden">
                        <div className="bg-slate-900 p-8 text-center text-white relative overflow-hidden">
                            <h2 className="text-2xl md:text-3xl font-bold mb-2 relative z-10">{message} {playerName}!</h2>
                            <div className={`text-6xl font-extrabold mb-2 relative z-10 ${color}`}>{points} <span className="text-2xl font-bold text-white opacity-80">pts</span></div>
                            <p className="text-slate-300 relative z-10">You answered {score} out of {total} correctly</p>
                        </div>
                        <div className="p-8">
                            <div className="grid grid-cols-2 gap-4 mb-8">
                                <div className="bg-green-50 p-4 rounded-xl border border-green-100 text-center"><span className="block text-2xl font-bold text-green-700">{score}</span><span className="text-xs font-bold text-green-600 uppercase tracking-wider">Correct</span></div>
                                <div className="bg-red-50 p-4 rounded-xl border border-red-100 text-center"><span className="block text-2xl font-bold text-red-700">{wrongCount}</span><span className="text-xs font-bold text-red-600 uppercase tracking-wider">Incorrect</span></div>
                            </div>
                            <div className="space-y-3 mb-6">
                                <button onClick={onRestart} className="w-full bg-slate-900 hover:bg-slate-800 text-white font-bold py-4 px-8 rounded-xl shadow-lg transition-transform active:scale-95">Restart Full Exam</button>
                                {wrongCount > 0 && <button onClick={onRetryWrong} className="w-full bg-white border-2 border-red-100 text-red-600 hover:bg-red-50 font-bold py-4 px-8 rounded-xl transition-transform active:scale-95">Retry Incorrect Answers ({wrongCount})</button>}
                            </div>
                            <div className="border-t pt-6">
                                <h3 className="font-bold text-gray-700 mb-4">Question Summary</h3>
                                <div className="space-y-3 max-h-64 overflow-y-auto custom-scrollbar pr-2">
                                    {results.map((res, index) => (
                                        <div key={index} className={`flex items-start p-3 rounded-lg text-sm ${res.isCorrect ? 'bg-green-50' : 'bg-red-50'}`}>
                                            <span className={`font-bold mr-3 ${res.isCorrect ? 'text-green-600' : 'text-red-600'}`}>#{index + 1}</span>
                                            <div className="flex-1">
                                                <p className="text-gray-800 mb-1 font-medium truncate">{res.userAnswer || "(No Answer)"}</p>
                                                {!res.isCorrect && <div className="mt-1"><p className="text-xs text-gray-500 uppercase font-semibold">Correct Answer:</p><p className="text-green-600 font-medium">{res.correctAnswer}</p></div>}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const ProgressBar = ({ current, total }) => {
            const progress = Math.min(100, Math.max(0, ((current) / total) * 100));
            return (
                <div className="w-full max-w-3xl mx-auto mb-6 px-4 md:px-0">
                    <div className="flex justify-between text-xs font-bold text-slate-500 mb-1 uppercase tracking-wider"><span>Progress</span><span>{current} / {total}</span></div>
                    <div className="h-3 bg-slate-200 rounded-full overflow-hidden"><div className="h-full bg-blue-500 transition-all duration-500 ease-out rounded-full" style={{ width: `${progress}%` }}></div></div>
                </div>
            );
        };

        const QuestionNavigation = ({ questions, answers, currentIndex, onSelectQuestion }) => {
            return (
                <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200 mt-6 w-full max-w-3xl">
                    <h3 className="text-sm font-bold text-slate-500 uppercase tracking-wider mb-3">Question Map</h3>
                    <div className="flex flex-wrap gap-2 max-h-40 overflow-y-auto custom-scrollbar">
                        {questions.map((q, idx) => {
                            const result = answers[q.id];
                            let btnClass = "w-8 h-8 md:w-10 md:h-10 text-xs md:text-sm font-bold rounded-lg flex items-center justify-center transition-all ";
                            if (idx === currentIndex) btnClass += "ring-2 ring-offset-2 ring-blue-500 ";
                            if (result) btnClass += result.isCorrect ? "bg-green-100 text-green-700 border border-green-200 hover:bg-green-200" : "bg-red-100 text-red-700 border border-red-200 hover:bg-red-200";
                            else btnClass += "bg-slate-100 text-slate-500 border border-slate-200 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200";
                            return <button key={q.id} onClick={() => onSelectQuestion(idx)} className={btnClass}>{idx + 1}</button>;
                        })}
                    </div>
                </div>
            );
        };

        const App = () => {
            const [gameState, setGameState] = useState(GameState.START);
            const [playerName, setPlayerName] = useState('');
            const [activeQuestions, setActiveQuestions] = useState(QUIZ_DATA);
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            const [answers, setAnswers] = useState({});
            const [showFeedback, setShowFeedback] = useState(false);

            const currentQuestion = activeQuestions[currentQuestionIndex];
            const totalQuestions = activeQuestions.length;
            const answeredCount = Object.keys(answers).length;
            const correctCount = Object.values(answers).filter(a => a.isCorrect).length;
            const currentPoints = correctCount * 10;

            const handleStartGame = (name) => {
                if (name && name.trim()) setPlayerName(name);
                setActiveQuestions(QUIZ_DATA);
                setGameState(GameState.PLAYING);
                setCurrentQuestionIndex(0);
                setAnswers({});
                setShowFeedback(false);
            };

            const handleRestart = () => handleStartGame();

            const handleRetryWrong = () => {
                const wrongQuestionIds = activeQuestions.filter(q => { const ans = answers[q.id]; return !ans || !ans.isCorrect; }).map(q => q.id);
                const wrongQuestions = QUIZ_DATA.filter(q => wrongQuestionIds.includes(q.id));
                if (wrongQuestions.length === 0) { handleStartGame(); return; }
                setActiveQuestions(wrongQuestions);
                setGameState(GameState.PLAYING);
                setCurrentQuestionIndex(0);
                setAnswers({});
                setShowFeedback(false);
            };

            const handleAnswerSubmit = (answer) => {
                const isCorrect = answer.toLowerCase().trim() === currentQuestion.correctAnswer.toLowerCase().trim();
                setAnswers(prev => ({ ...prev, [currentQuestion.id]: { questionId: currentQuestion.id, isCorrect, userAnswer: answer, correctAnswer: currentQuestion.correctAnswer } }));
                setShowFeedback(true);
            };

            const jumpToQuestion = (index) => {
                setCurrentQuestionIndex(index);
                const targetQ = activeQuestions[index];
                setShowFeedback(!!answers[targetQ.id]);
            };

            const handleNextQuestion = () => {
                if (currentQuestionIndex < totalQuestions - 1) jumpToQuestion(currentQuestionIndex + 1);
                else {
                    if (answeredCount === totalQuestions) setGameState(GameState.FINISHED);
                    else {
                        const firstUnanswered = activeQuestions.findIndex(q => !answers[q.id]);
                        if (firstUnanswered !== -1) jumpToQuestion(firstUnanswered);
                        else setGameState(GameState.FINISHED);
                    }
                }
            };

            useEffect(() => { window.scrollTo({ top: 0, behavior: 'smooth' }); }, [currentQuestionIndex, gameState]);

            return (
                <div className="min-h-screen bg-slate-100 font-sans text-slate-800 flex flex-col">
                    <header className="bg-white border-b border-slate-200 sticky top-0 z-20 shadow-sm">
                        <div className="max-w-5xl mx-auto px-4 py-3 flex justify-between items-center">
                            <div className="flex items-center space-x-2">
                                <div className="bg-blue-600 text-white p-1.5 rounded-lg shadow-sm">
                                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>
                                </div>
                                <h1 className="font-bold text-lg hidden sm:block">IOE Master</h1>
                            </div>
                            {gameState === GameState.PLAYING && (
                                <div className="flex items-center gap-4">
                                    {playerName && <div className="hidden sm:flex items-center text-sm font-bold text-slate-500 bg-slate-50 px-3 py-1.5 rounded-lg border border-slate-200">{playerName}</div>}
                                    <div className="bg-blue-50 px-3 py-1.5 rounded-lg border border-blue-100 flex items-center"><span className="text-xs text-blue-600 font-bold uppercase mr-2">Points</span><span className="text-lg font-extrabold text-blue-700">{currentPoints}</span></div>
                                    <button onClick={() => setGameState(GameState.FINISHED)} className="text-xs font-bold text-slate-500 hover:text-red-500 uppercase tracking-wide px-2">Finish</button>
                                </div>
                            )}
                        </div>
                    </header>

                    <main className="flex-grow flex flex-col items-center justify-center p-4 md:p-6 w-full max-w-5xl mx-auto">
                        {gameState === GameState.START && <StartScreen onStart={handleStartGame} totalQuestions={QUIZ_DATA.length} />}
                        {gameState === GameState.PLAYING && currentQuestion && (
                            <div className="w-full flex flex-col items-center pb-20 md:pb-0">
                                <ProgressBar current={currentQuestionIndex + 1} total={totalQuestions} />
                                <QuestionCard key={currentQuestion.id} question={currentQuestion} onAnswerSubmit={handleAnswerSubmit} showFeedback={showFeedback} userAnswer={answers[currentQuestion.id]?.userAnswer || null} />
                                <QuestionNavigation questions={activeQuestions} answers={answers} currentIndex={currentQuestionIndex} onSelectQuestion={jumpToQuestion} />
                                {showFeedback && (
                                    <div className="fixed bottom-0 left-0 w-full p-4 bg-white border-t border-gray-200 md:relative md:bg-transparent md:border-0 md:p-0 md:mt-6 z-30 flex justify-center animate-slide-up shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] md:shadow-none">
                                        <button onClick={handleNextQuestion} className="w-full md:w-auto bg-slate-900 hover:bg-slate-800 text-white text-lg font-bold py-3 px-12 rounded-xl shadow-xl transition-transform active:scale-95 flex items-center justify-center">
                                            <span>{currentQuestionIndex === totalQuestions - 1 && answeredCount === totalQuestions ? "Finish Exam" : "Next Question"}</span>
                                            <svg className="w-5 h-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 5l7 7m0 0l-7 7m7-7H3" /></svg>
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}
                        {gameState === GameState.FINISHED && <ResultScreen playerName={playerName} score={correctCount} points={currentPoints} total={totalQuestions} results={activeQuestions.map(q => answers[q.id] || { questionId: q.id, isCorrect: false, userAnswer: '', correctAnswer: q.correctAnswer })} onRestart={handleRestart} onRetryWrong={handleRetryWrong} />}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>